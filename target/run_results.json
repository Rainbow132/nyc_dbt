{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2024-12-02T14:50:33.497804Z", "invocation_id": "1d277241-d40e-4235-af67-9e942ab0c474", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-02T14:50:08.538600Z", "completed_at": "2024-12-02T14:50:08.553598Z"}, {"name": "execute", "started_at": "2024-12-02T14:50:08.555599Z", "completed_at": "2024-12-02T14:50:33.485419Z"}], "thread_id": "Thread-2", "execution_time": 24.948382139205933, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.homework.fact_trips", "compiled": true, "compiled_code": "\n\n-- 1. \u9996\u5148\u5904\u7406\u7eff\u8272\u51fa\u79df\u8f66\u6570\u636e\uff0cref \u51fd\u6570\u7528\u4e8e\u5f15\u7528\u5176\u4ed6\u6a21\u578b\uff0c\u5e76\u7ba1\u7406\u6a21\u578b\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u3002\n--\u8fd9\u91cc\u7684 WITH ... AS \u7ed3\u6784\u662f SQL \u4e2d\u7684\u516c\u7528\u8868\u8868\u8fbe\u5f0f\uff08Common Table Expression\uff0c\u7b80\u79f0 CTE\uff09\uff0c\u5b83\u5141\u8bb8\u5728\u4e00\u4e2a\u67e5\u8be2\u4e2d\u5b9a\u4e49\u4e34\u65f6\u7ed3\u679c\u96c6\uff0c\u8fd9\u4e9b\u7ed3\u679c\u96c6\u53ef\u4ee5\u5728\u540e\u7eed\u7684\u67e5\u8be2\u4e2d\u5f15\u7528\u3002\nwith green_trips as (\n    select \n        tripid,\n        vendor_id,\n        'Green' as service_type,\n        pickup_datetime,\n        dropoff_datetime,\n        store_and_fwd_flag,\n        ratecode_id,\n        pickup_locationid,\n        dropoff_locationid,\n        passenger_count,\n        trip_distance,\n        fare_amount,\n        extra,\n        mta_tax,\n        tip_amount,\n        tolls_amount,\n        improvement_surcharge,\n        total_amount,\n        payment_type,\n        congestion_surcharge\n    from `dataengine_learning`.`default`.`stg_green_tripdata`\n),\n\n-- 2. \u5904\u7406\u9ec4\u8272\u51fa\u79df\u8f66\u6570\u636e\nyellow_trips as (\n    select \n        tripid,\n        vendor_id,\n        'Yellow' as service_type,\n        pickup_datetime,\n        dropoff_datetime,\n        null as store_and_fwd_flag,\n        ratecode_id,\n        pickup_locationid,\n        dropoff_locationid,\n        passenger_count,\n        trip_distance,\n        fare_amount,\n        null as extra,\n        null as mta_tax,\n        null as tip_amount,\n        null as tolls_amount,\n        null as improvement_surcharge,\n        total_amount,\n        payment_type,\n        null as congestion_surcharge\n    from `dataengine_learning`.`default`.`stg_yellow_tripdata`\n),\n\n-- 3. \u5408\u5e76\u4e24\u79cd\u6570\u636e\uff0cunion all \u662f SQL \u4e2d\u7684\u96c6\u5408\u8fd0\u7b97\u7b26\uff0c\u7528\u4e8e\u5408\u5e76\u4e24\u4e2a\u6216\u591a\u4e2a\u67e5\u8be2\u7684\u7ed3\u679c\u96c6\uff0cunion all \u4f1a\u4fdd\u7559\u91cd\u590d\u7684\u884c\uff0c\u800c union \u4f1a\u53bb\u9664\u91cd\u590d\u7684\u884c\u3002\ntrips_unioned as (\n    select * from green_trips\n    union all\n    select * from yellow_trips\n),\n\n-- 4. \u5173\u8054\u7ef4\u5ea6\u4fe1\u606f\uff0cINNER JOIN \u7528\u4e8e\u8fde\u63a5\u4e24\u4e2a\u8868\uff0c\u800c ON \u5b50\u53e5\u7528\u4e8e\u6307\u5b9a\u8fde\u63a5\u6761\u4ef6\u3002\nfinal as (\n    select \n        trips_unioned.tripid,\n        trips_unioned.vendor_id,\n        trips_unioned.service_type,\n        trips_unioned.pickup_datetime,\n        trips_unioned.dropoff_datetime,\n        trips_unioned.store_and_fwd_flag,\n        trips_unioned.ratecode_id,\n        trips_unioned.pickup_locationid,\n        trips_unioned.dropoff_locationid,\n        trips_unioned.passenger_count,\n        trips_unioned.trip_distance,\n        trips_unioned.fare_amount,\n        trips_unioned.extra,\n        trips_unioned.mta_tax,\n        trips_unioned.tip_amount,\n        trips_unioned.tolls_amount,\n        trips_unioned.improvement_surcharge,\n        trips_unioned.total_amount,\n        trips_unioned.payment_type,\n        trips_unioned.congestion_surcharge,\n        pickup_zone.borough as pickup_borough,\n        pickup_zone.zone as pickup_zone,\n        dropoff_zone.borough as dropoff_borough,\n        dropoff_zone.zone as dropoff_zone\n\n    from trips_unioned\n    inner join `dataengine_learning`.`default`.`dim_zones` as pickup_zone\n        on trips_unioned.pickup_locationid = pickup_zone.locationid\n    inner join `dataengine_learning`.`default`.`dim_zones` as dropoff_zone\n        on trips_unioned.dropoff_locationid = dropoff_zone.locationid\n)\n\nselect * from final", "relation_name": "`dataengine_learning`.`default`.`fact_trips`"}], "elapsed_time": 31.095380067825317, "args": {"profiles_dir": "C:\\Users\\\u6770\u54e5\u5e26\u5e05\u6bd4\\.dbt", "indirect_selection": "eager", "partial_parse_file_diff": true, "log_level": "info", "cache_selected_only": false, "source_freshness_run_project_hooks": false, "use_colors_file": true, "exclude": [], "select": ["fact_trips"], "defer": false, "log_path": "E:\\\u7a0b\u5e8f\\data-engineering-zoomcamp-main\\04-analytics-engineering\\homework\\logs", "send_anonymous_usage_stats": true, "introspect": true, "print": true, "which": "run", "require_resource_names_without_spaces": false, "log_format": "default", "quiet": false, "favor_state": false, "warn_error_options": {"include": [], "exclude": []}, "project_dir": "E:\\\u7a0b\u5e8f\\data-engineering-zoomcamp-main\\04-analytics-engineering\\homework", "strict_mode": false, "populate_cache": true, "empty": false, "log_file_max_bytes": 10485760, "static_parser": true, "require_explicit_package_overrides_for_builtin_materializations": true, "enable_legacy_logger": false, "invocation_command": "dbt run -m fact_trips --full-refresh", "macro_debugging": false, "use_colors": true, "printer_width": 80, "write_json": true, "log_level_file": "debug", "partial_parse": true, "version_check": true, "vars": {}, "log_format_file": "debug", "full_refresh": true, "show_resource_report": false}}